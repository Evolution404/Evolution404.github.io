---
title: vim查找正则剖析
date: 2018-07-15 14:03:55
tags:
- 效率
categories:
- vim
---

### vim查找偏移量

#### 基本偏移量
```
[num]	[num] 行向下，第一列
+[num]	[num] 行向下，第一列
-[num]	[num] 行向上，第一列
e[+num]	[num] 字符向右 (从匹配结束 (end) 处算起)
e[-num]	[num] 字符向左 (从匹配结束 (end) 处算起)
s[+num]	[num] 字符向右 (从匹配开始 (start) 处算起)
s[-num]	[num] 字符向左 (从匹配开始 (start) 处算起)
b[+num]	[num] 等价于 s[+num] (从匹配开始 (begin) 处算起)
b[-num]	[num] 等价于 s[-num] (从匹配开始 (begin) 处算起)
;{pattern}  开始另一项搜索，见 |//;|

```

例如:有一行 `hello world, good pattern`
执行`d/oo<cr>` 结果是 `ood pattern`
执行`d/oo/e<cr>` 结果是 `d pattern`
> e代表匹配的结尾
> 偏移量的s和b等价,都代表开始

#### ;的应用

一个很特别的偏移是 ';' 后面接另一个查找命令。例如: >

```bash
/test 1/;/test
/test.*/+1;?ing?
```

```
其中第一例会先找到下一个出现 "test 1" 的地方，然后寻找在它之后 "test" 的第一次
出现之处。

这就好象接连执行两次查找命令，不同之处在于:
- 它可以被当作操作符之后的单个移动命令。
- 以后的 "n" 或 "N" 命令基于第一个查找操作。
- 当有错误时光标原地不动。
```

### 分支,邻接,组件

例如:`abcefghijk`
使用`/\vaaa|jk` 会匹配`jk`
使用`/\vefgh&..` 会匹配`ef`

### 贪婪匹配和非贪婪匹配

#### 贪婪匹配

如下查询:`babbaabbaaab`
`/\c\vba{2,}b` 可以匹配如`baab` `baaab` `baaaab`

#### 非贪婪匹配
>特别的 `{-}`与`*`等价只是前者为非贪婪匹配

如下查询:`abcbbbc`
`/\c\va.{}c` 匹配`abcbbbc`
`/\c\va.{-}c` 匹配`abc`


### 零宽断言
> vim中零宽断言使用@关键字

#### 正零宽先行断言
```
希望匹配后方为大写字母的ab
abc
abC
abA
```

使用命令`\vab([A-Z])@=`
原理: 前方使用分组即`@=`对应的匹配条件

##### 匹配不符合表达式的
`/\vab[A-Z]@!`
就会匹配`abc`中的`ab`


### 特殊字符
特殊字符帮助命令
```bash
:h pattern-atoms
```

```
\zs	匹配任何位置，并将匹配起始处置于该处: 下一个字符将是整个匹配的第一个字
	符。|/zero-width|
	例如: >
		"^\s*\zsif"
	匹配行首的 "if"，忽略前导的空白字符。
	可以使用多次，但实际使用最后一次在匹配的分支里遇到的。例如: >
		/\(.\{-}\zsFab\)\{3}
	找到第三次出现的 "Fab"。
```
同理`\ze`设置此处为匹配结尾

[vim正则的文章](https://www.jianshu.com/p/03770041397c)
